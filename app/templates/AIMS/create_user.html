{% extends "home.html" %}

{% set create_title = "新增" %}
{% if createForm.type.data == 'advisor' %}
    {% set create_title = create_title + "導師" %}
{% elif createForm.type.data == 'student' %}
    {% set create_title = create_title + "學生" %}
{% endif %}
{% set create_title = create_title + "使用者" %}

{% block title %} 新增使用者 {% endblock title %}

{% block heading %}
    <div class="d-sm-flex align-items-center justify-content-between">
        <span class="h3 mb-0 text-gray-800 font-weight-bold">新增使用者</span>
    </div>
{% endblock heading %}

{% block content %}
    {% if createForm != None %}
        <div class="container mt-5">
            <h2 class="text-center">新增使用者</h2>
            <div class="row">
                <div class="col-md-8 offset-md-2">
                    <form id="user-form" action="{{ url_for('create_user.create_form') }}">
                        {{ createForm.hidden_tag() }}

                        {# User #}
                        {# User.id #}
                        <div class="form-group row">
                            {{ createForm.id.label(class='col-sm-3 col-form-label') }}
                            <div class="col-sm-9">
                                {{ createForm.id(class='form-control', disabled='disabled') }}
                            </div>
                        </div>
                        {# User.name #}
                        <div class="form-group row">
                            {{ createForm.name.label(class='col-sm-3 col-form-label') }}
                            <div class="col-sm-9">
                                {{ createForm.name(class='form-control', disabled='disabled') }}
                            </div>
                        </div>
                        {# User.passwd #}
                        <div class="form-group row">
                            {{ createForm.passwd.label(class='col-sm-3 col-form-label') }}
                            <div class="col-sm-6">
                                {{ createForm.passwd(class='form-control', disabled='disabled') }}
                            </div>
                            <div class="col-sm-3">
                                <button type="button" class="btn btn-primary btn-block"
                                        onclick="showEditField('password')">
                                    修改密碼
                                </button>
                            </div>
                        </div>
                        {# User.tel #}
                        <div class="form-group row">
                            {{ createForm.tel.label(class='col-sm-3 col-form-label') }}
                            <div class="col-sm-6">
                                {{ createForm.tel(class='form-control', disabled='disabled') }}
                            </div>
                            <div class="col-sm-3">
                                <button type="button" class="btn btn-primary btn-block"
                                        onclick="showEditField('phone')">
                                    修改電話
                                </button>
                            </div>
                        </div>
                        {# User.email #}
                        <div class="form-group row">
                            {{ createForm.email.label(class='col-sm-3 col-form-label') }}
                            <div class="col-sm-6">
                                {{ createForm.email(class='form-control', disabled='disabled') }}
                            </div>
                            <div class="col-sm-3">
                                <button type="button" class="btn btn-primary btn-block"
                                        onclick="showEditField('email')">
                                    修改信箱
                                </button>
                            </div>
                        </div>

                        {# Advisor #}
                        {% if createForm.type.data == 'advisor' %}
                            {# Advisor.dept #}
                            <div class="form-group row">
                                {{ createForm.dept.label(class='col-sm-3 col-form-label') }}
                                <div class="col-sm-6">
                                    {{ createForm.dept(class='form-control', disabled='disabled') }}
                                </div>
                                <div class="col-sm-3">
                                    <button type="button" class="btn btn-primary btn-block"
                                            onclick="showEditField('dept')">
                                        修改系所
                                    </button>
                                </div>
                            </div>
                            {# Advisor.rank #}
                            <div class="form-group row">
                                {{ createForm.rank.label(class='col-sm-3 col-form-label') }}
                                <div class="col-sm-6">
                                    {{ createForm.rank(class='form-control', disabled='disabled') }}
                                </div>
                                <div class="col-sm-3">
                                    <button type="button" class="btn btn-primary btn-block"
                                            onclick="showEditField('rank')">
                                        修改職級
                                    </button>
                                </div>
                            </div>
                            {# Advisor.office_addr #}
                            <div class="form-group row">
                                {{ createForm.office_addr.label(class='col-sm-3 col-form-label') }}
                                <div class="col-sm-6">
                                    {{ createForm.office_addr(class='form-control', disabled='disabled') }}
                                </div>
                                <div class="col-sm-3">
                                    <button type="button" class="btn btn-primary btn-block"
                                            onclick="showEditField('office_addr')">
                                        修改辦公室位址
                                    </button>
                                </div>
                            </div>
                            {# Advisor.office_tel #}
                            <div class="form-group row">
                                {{ createForm.office_tel.label(class='col-sm-3 col-form-label') }}
                                <div class="col-sm-6">
                                    {{ createForm.office_tel(class='form-control', disabled='disabled') }}
                                </div>
                                <div class="col-sm-3">
                                    <button type="button" class="btn btn-primary btn-block"
                                            onclick="showEditField('office_tel')">
                                        修改辦公室電話
                                    </button>
                                </div>
                            </div>
                        {% endif %}

                        {# Student #}
                        {% if createForm.type.data == 'student' %}
                            {# Student.dept #}
                            <div class="form-group row">
                                {{ createForm.dept.label(class='col-sm-3 col-form-label') }}
                                <div class="col-sm-6">
                                    {{ createForm.dept(class='form-control', disabled='disabled') }}
                                </div>
                                <div class="col-sm-3">
                                    <button type="button" class="btn btn-primary btn-block"
                                            onclick="showEditField('dept')">
                                        修改系所
                                    </button>
                                </div>
                            </div>
                            {# Student.enroll_year #}
                            <div class="form-group row">
                                {{ createForm.enroll_year.label(class='col-sm-3 col-form-label') }}
                                <div class="col-sm-6">
                                    {{ createForm.enroll_year(class='form-control', disabled='disabled') }}
                                </div>
                                <div class="col-sm-3">
                                    <button type="button" class="btn btn-primary btn-block"
                                            onclick="showEditField('enroll_year')">
                                        修改入學年分
                                    </button>
                                </div>
                            </div>
                            {# Student.sex #}
                            <div class="form-group row">
                                {{ createForm.sex.label(class='col-sm-3 col-form-label') }}
                                <div class="col-sm-6">
                                    {% for subfield in createForm.sex %}
                                        <div class="form-check form-check-inline">
                                            {{ subfield(disabled='disabled', class='form-check-input') }}
                                            {{ subfield.label(class='form-check-label') }}
                                        </div>
                                    {% endfor %}
                                </div>
                                <div class="col-sm-3">
                                    <button type="button" class="btn btn-primary btn-block"
                                            onclick="showEditField('sex')">
                                        修改性別
                                    </button>
                                </div>
                            </div>
                            {# Student.home_addr #}
                            <div class="form-group row">
                                {{ createForm.home_addr.label(class='col-sm-3 col-form-label') }}
                                <div class="col-sm-6">
                                    {{ createForm.home_addr(class='form-control', disabled='disabled') }}
                                </div>
                                <div class="col-sm-3">
                                    <button type="button" class="btn btn-primary btn-block"
                                            onclick="showEditField('home_addr')">
                                        修改家中住址
                                    </button>
                                </div>
                            </div>
                            {# Student.home_tel #}
                            <div class="form-group row">
                                {{ createForm.home_tel.label(class='col-sm-3 col-form-label') }}
                                <div class="col-sm-6">
                                    {{ createForm.home_tel(class='form-control', disabled='disabled') }}
                                </div>
                                <div class="col-sm-3">
                                    <button type="button" class="btn btn-primary btn-block"
                                            onclick="showEditField('home_tel')">
                                        修改家裡電話
                                    </button>
                                </div>
                            </div>
                            {# Student.contact_name #}
                            <div class="form-group row">
                                {{ createForm.contact_name.label(class='col-sm-3 col-form-label') }}
                                <div class="col-sm-6">
                                    {{ createForm.contact_name(class='form-control', disabled='disabled') }}
                                </div>
                                <div class="col-sm-3">
                                    <button type="button" class="btn btn-primary btn-block"
                                            onclick="showEditField('contact_name')">
                                        修改家裡聯絡人姓名
                                    </button>
                                </div>
                            </div>
                            {# Student.contact_tel #}
                            <div class="form-group row">
                                {{ createForm.contact_tel.label(class='col-sm-3 col-form-label') }}
                                <div class="col-sm-6">
                                    {{ createForm.contact_tel(class='form-control', disabled='disabled') }}
                                </div>
                                <div class="col-sm-3">
                                    <button type="button" class="btn btn-primary btn-block"
                                            onclick="showEditField('contact_tel')">
                                        修改家裡聯絡人電話
                                    </button>
                                </div>
                            </div>
                        {% endif %}

                    </form>

                    <div class=" form-group row mt-4
                        " id="edit-field" style="display:none;">
                        <label for="newValue" class="col-sm-3 col-form-label">新值</label>
                        <div class="col-sm-6">
                            <input type="text" class="form-control" id="newValue">
                        </div>
                        <div class="col-sm-3">
                            <button type="button" class="btn btn-success btn-block" onclick="updateField()">修改完成
                            </button>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    {% endif %}

    {# flash message #}
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="mt-3">
                {% for category, message in messages %}
                    <div class="row justify-content-center">
                        <div class="col-6 text-center">
                            <h3 class="alert alert-{{ category }} text-center"> {{ message }} </h3>
                            <a href="{{ url_for('search_user_information.search_form') }}"
                               class="btn btn-primary text-center">返回</a>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

{% endblock %}